starting from core

exit<64> := @[rsp, 8]
return_address<64> := @[rsp, 8]

stdin_p<64> := 0

replace <socket_read> by
  for i<64> in 0 to rdx - 1 do
    @[rsi + i] := stdin[stdin_p]
    stdin_p := stdin_p + 1
  end
  return rdi
end

replace <open64>, <fstatat64>, <syscall>, <close>, <getpeername> by
  return
end

replace <tcgetattr>, <gettimeofday> by
  return
end

reach <malloc> such that rdi = 0 then print c string stdin

halt at <__stack_chk_fail>
halt at exit
